<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
  <!-- Security and Performance -->
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  <meta name="referrer" content="no-referrer-when-downgrade">
  
  <!-- PWA Support -->
  <meta name="theme-color" content="#8b5cf6">
  <meta name="apple-mobile-web-app-title" content="Game CAM">
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon.svg">
  <link rel="apple-touch-icon" sizes="180x180" href="favicon.svg">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="">
  <meta property="og:title" content="Game CAM - Detec√ß√£o Facial com IA">
  <meta property="og:description" content="Sistema avan√ßado de detec√ß√£o facial usando intelig√™ncia artificial. Monitoramento em tempo real com alerts autom√°ticos e envio para WhatsApp.">
  <meta property="og:image" content="og-image.svg">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:type" content="image/svg+xml">
  <meta property="og:site_name" content="Game CAM">
  <meta property="og:locale" content="pt_BR">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="">
  <meta name="twitter:title" content="Game CAM - Detec√ß√£o Facial com IA">
  <meta name="twitter:description" content="Sistema avan√ßado de detec√ß√£o facial usando intelig√™ncia artificial. Monitoramento em tempo real com alerts autom√°ticos e envio para WhatsApp.">
  <meta name="twitter:image" content="og-image.svg">
  <meta name="twitter:creator" content="@blazysoftware">
  
  <!-- SEO Meta Tags -->
  <meta name="description" content="Sistema avan√ßado de detec√ß√£o facial usando intelig√™ncia artificial. Monitoramento em tempo real com alerts autom√°ticos.">
  <meta name="keywords" content="detec√ß√£o facial, intelig√™ncia artificial, IA, c√¢mera, monitoramento, seguran√ßa, reconhecimento facial">
  <meta name="author" content="Blazy Software">
  
  <title>Game CAM</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  
  <!-- TensorFlow.js -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd@2.2.3/dist/coco-ssd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/blazeface@0.0.7/dist/blazeface.min.js"></script>
  
  <!-- SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <h1 class="logo">
        AI Detection
        <span class="security-badge" id="securityBadge">üîí</span>
      </h1>
      <div class="header-actions">
        <button class="menu-btn" id="menuBtn">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </div>
  </header>

  <!-- Splash Screen -->
  <div class="splash-screen" id="splashScreen" style="display: none;">
    <div class="splash-content">
      <div class="splash-logo">
        <p>Ative a C√¢mera para JOGAR no site</p>
      </div>
      <div class="splash-loader">
        <div class="loading-dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
        <p>Aguardando c√¢mera...</p>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <main class="main">
    <!-- Video Container -->
    <div class="video-section">
      <div class="video-container">
        <video id="video" playsinline autoplay muted></video>
        <canvas id="detectionOverlay"></canvas>
        <canvas id="capture" style="display: none;"></canvas>
        
        <!-- Auto-start Overlay -->
        <div class="auto-start-overlay" id="autoStartOverlay">
          <div class="auto-start-content"> 

            <div class="countdown" id="countdown">5</div>
            <h3>ü§ñ Sistema de Auto-Aceite Ativo</h3>
            <p>C√¢mera ser√° solicitada automaticamente</p>
            <button class="btn-primary" id="startNowBtn">Ativar Agora</button>
            <button class="btn-secondary" id="cancelAutoBtn">Cancelar</button>
          </div>
        </div>

        <!-- Camera Permission (Auto-Accept) -->
        <div class="camera-permission" id="cameraPermission" style="display: none;">
          <div class="permission-content">
            <div class="auto-permission-icon">ü§ñ</div>
            <h3>Solicitando Acesso Autom√°tico</h3>
            <p>O sistema ir√° solicitar permiss√£o automaticamente</p>
            <div class="auto-permission-info">
              <p>‚úÖ Clique em <strong>"Permitir"</strong> no popup do navegador</p>
              <p>üîí Suas permiss√µes ser√£o salvas automaticamente</p>
            </div>
          </div>
        </div>

        <!-- Loading -->
        <div class="loading-overlay" id="loadingOverlay" style="display: none;">
          <div class="loading-content">
            <div class="loading-spinner"></div>
            <p id="loadingText">Carregando modelos IA...</p>
          </div>
        </div>
      </div>

      <!-- Controls -->
      <div class="controls">
        <button class="control-btn" id="toggleBtn">
          <span class="btn-text">Iniciar</span>
        </button>
        <button class="control-btn secondary" id="captureBtn" disabled>
          <span class="btn-text">Capturar</span>
        </button>
        <button class="control-btn secondary" id="hiddenModeBtn">
          <span class="btn-text">Modo Oculto</span>
        </button>
        <!-- Debug button -->
        <button class="control-btn secondary" id="debugBtn" style="display: none;">
          <span class="btn-text">Debug Stop</span>
        </button>
      </div>
    </div>

    <!-- Stats Cards -->
    <div class="stats-section">
      <div class="stat-card">
        <div class="stat-value" id="personCount">0</div>
        <div class="stat-label">Pessoas</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="faceCount">0</div>
        <div class="stat-label">Rostos</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="totalDetections">0</div>
        <div class="stat-label">Total</div>
      </div>
    </div> 

    <!-- Quick Settings -->
    <div class="quick-settings">
      <div class="setting-item">
        <span class="setting-label">Desenhar Elemento</span>
        <label class="toggle">
          <input type="checkbox" id="drawBoxes" checked>
          <span class="slider"></span>
        </label>
      </div>
      <div class="setting-item">
        <span class="setting-label">Enviar Captura</span>
        <label class="toggle">
          <input type="checkbox" id="captureEnabled" checked>
          <span class="slider"></span>
        </label>
      </div>
    </div>
  </main>

  <!-- Side Menu -->
  <div class="side-menu" id="sideMenu">
    <div class="menu-header">
      <h2>Configura√ß√µes</h2>
      <button class="close-menu" id="closeMenu">x</button>
    </div>
    
    <div class="menu-content">
      <!-- Webhook Settings -->
      <div class="menu-section">
        <h3>Webhook</h3>
        <div class="input-group">
          <label>URL do Webhook</label>
          <input type="url" id="webhookUrl" value="https://workflow.blazysoftware.com.br/webhook/pego-no-pulo">
        </div>
        <div class="input-group">
          <label>Telefone (WhatsApp)</label>
          <input type="tel" id="phoneInput" placeholder="+55 62 98116 66035" inputmode="tel" />
          <small class="input-help">Formato: +55 62 98333 6333 ‚Äî ser√° exigido para ativar a c√¢mera</small>
        </div>
        <button class="btn-secondary full-width" id="testWebhook">Testar Conex√£o</button>
        <div class="status-text" id="webhookStatus">N√£o configurado</div>
      </div>

      <!-- Detection Settings -->
      <div class="menu-section">
        <h3>Detec√ß√£o</h3>
        
        <div class="range-group">
          <label>Sensibilidade Pessoas</label>
          <input type="range" id="confidence" min="0" max="1" step="0.05" value="0.6">
          <span class="range-value" id="confidenceValue">60%</span>
        </div>

        <div class="range-group">
          <label>Sensibilidade Rostos</label>
          <input type="range" id="faceConfidence" min="0" max="1" step="0.05" value="0.7">
          <span class="range-value" id="faceConfidenceValue">70%</span>
        </div>

        <div class="range-group">
          <label>Intervalo de Alertas</label>
          <input type="range" id="cooldown" min="0" max="60" value="5">
          <span class="range-value" id="cooldownValue">5s</span>
        </div>

        <div class="range-group">
          <label>Performance (FPS)</label>
          <input type="range" id="performance" min="1" max="30" value="5">
          <span class="range-value" id="performanceValue">5 FPS (Mobile)</span>
        </div>

        <div class="range-group">
          <label>Delay Captura (Frames para Frente)</label>
          <input type="range" id="captureDelay" min="0" max="8" value="3">
          <span class="range-value" id="captureDelayValue">3 frames (~600ms)</span>
        </div>
      </div>

      <!-- System Info -->
      <div class="menu-section">
        <h3>Sistema</h3>
        <div class="info-item">
          <span>Status da C√¢mera</span>
          <span class="status-badge" id="cameraStatus">Offline</span>
        </div>
        <div class="info-item">
          <span>Modelo Pessoas</span>
          <span class="status-badge" id="modelStatus">Carregando</span>
        </div>
        <div class="info-item">
          <span>Modelo Faces</span>
          <span class="status-badge" id="faceModelStatus">Carregando</span>
        </div>
        <div class="info-item">
          <span>√öltimo Envio</span>
          <span class="status-text" id="lastSend">Nunca</span>
        </div>
      </div>

      <!-- Theme Settings -->
      <div class="menu-section">
        <h3>Apar√™ncia</h3>
        <div class="setting-item">
          <span class="setting-label">Tema Escuro</span>
          <label class="toggle">
            <input type="checkbox" id="darkModeToggle">
            <span class="slider"></span>
          </label>
        </div>
      </div>

      <!-- Actions -->
      <div class="menu-section">
        <h3>A√ß√µes</h3>
        <button class="btn-secondary full-width" id="generateShareUrl">üîó Gerar URL Compartilhamento</button>
        <button class="btn-secondary full-width" id="clearCache">üóëÔ∏è Limpar Tudo</button>
        <button class="btn-secondary full-width" id="modelInfo">Info dos Modelos</button>
        <button class="btn-secondary full-width" id="clearToasts">Limpar Notifica√ß√µes</button>
        <button class="btn-secondary full-width" id="testToasts">Testar Notifica√ß√µes</button>
      </div>
    </div>
  </div>

  <!-- Overlay -->
  <div class="overlay" id="overlay"></div>

  <!-- Toast Notifications -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Hidden Mode Overlay -->
  <div class="hidden-overlay" id="hiddenOverlay" style="display: none;">
    <iframe id="hiddenFrame" src="" frameborder="0"></iframe>
    <button id="hiddenCloseBtn" class="hidden-close-btn">X</button>
  </div>

  <script src="app.js"></script>
</body>
</html>